<div
  class="c-todo-item p-4 md:p-5 xl:p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all relative h-full bg-white flex flex-col"
  [ngClass]="{'c-completed': completed()}">
  <div class="flex gap-3 items-start mb-2">
    <mat-checkbox disableRipple [checked]="completed()" [disabled]="isCompleting()" (change)="onCompletedChange()"
      class="shrink-0">
    </mat-checkbox>
    <h3 class="c-todo-title text-md font-semibold grow shrink w-0 text-gray-900">{{ todo().title }}</h3>
    <button [matMenuTriggerFor]="menu" class="text-gray-400 hover:text-gray-600 shrink-0">
      <fa-icon [icon]="faEllipsisVertical"></fa-icon>
    </button>
  </div>

  <p class="c-todo-description text-sm text-gray-600 grow">{{ todo().description }}</p>

  <div class="mt-4 pt-3 border-t border-gray-200 space-y-1.5">
    @if (todo().updatedAt) {
    <ng-container *ngTemplateOutlet="todoTimestamp; context: { label: 'Updated', value: todo().updatedAt }">
    </ng-container>
    }
    @if (todo().createdAt) {
    <ng-container *ngTemplateOutlet="todoTimestamp; context: { label: 'Created', value: todo().createdAt }">
    </ng-container>
    }
  </div>

  <mat-menu #menu="matMenu">
    <button mat-menu-item (click)="onEdit()">
      <fa-icon [icon]="faPenToSquare" class="text-blue-600 mr-2"></fa-icon>
      <span class="text-blue-600">Edit</span>
    </button>
    <button mat-menu-item (click)="onDelete()">
      <fa-icon [icon]="faTrash" class="text-red-600 mr-2"></fa-icon>
      <span class="text-red-600">Delete</span>
    </button>
  </mat-menu>
</div>

<ng-template #todoTimestamp let-label="label" let-value="value">
  <p class="flex items-center gap-2 text-xs">
    <span class="font-semibold uppercase tracking-wide text-gray-500">{{ label }}</span>
    <span class="text-gray-700">{{ value | date:'MMM d, y, h:mm a' }}</span>
  </p>
</ng-template>