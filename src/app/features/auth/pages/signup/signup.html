<div class="auth-form">
    <div class="mb-8 text-center">
        <h1 class="text-3xl font-bold text-gray-900">Sign Up</h1>
        <p class="text-gray-600 text-sm mt-2">Create your account</p>
    </div>
    @if (signupForm) {
    <form [formGroup]="signupForm" (ngSubmit)="onSubmit()" class="space-y-5">

        <!-- Added to extra dummy field to stop browser auto porefield -->
        <input type="text" name="username" class="sr-only" />
        <input type="password" name="password" class="sr-only" />

        @let nameControl=signupForm.controls.name;
        <app-form-fields [fieldConfig]="{label: 'Name'}" [dynamicFormControl]="nameControl"
            [clickedOnSubmitButton]="clickedOnSubmitButton">
            <input type="text" [formControl]="nameControl" class="form-field" [placeholder]="'Enter text'" name="name"
                appSanitizeInput />
        </app-form-fields>

        @let usernameControl=signupForm.controls.username;
        <app-form-fields [fieldConfig]="{label: 'Username'}" [dynamicFormControl]="usernameControl"
            [clickedOnSubmitButton]="clickedOnSubmitButton" (hasError)="usernameValidetorHasError=$event">
            <input type="text" [formControl]="usernameControl" class="form-field" [placeholder]="'Enter text'"
                name="username" appSanitizeInput [noSpaceAllow]="true" />
        </app-form-fields>
        @if (!usernameValidetorHasError) {
        <div>
            @if (usernameControl.errors?.['usernameExists']) {
            <span class="text-danger">❌ Username is already taken. Please choose another.</span>
            } @else {
            <span class="text-success">✅ Username is available.</span>
            }
        </div>
        }

        @let passwordControl=signupForm.controls.password;
        <app-form-fields [fieldConfig]="{label: 'Password'}" [dynamicFormControl]="passwordControl"
            [clickedOnSubmitButton]="clickedOnSubmitButton">
            <input type="password" [formControl]="passwordControl" class="form-field" name="password"
                [placeholder]="'Enter password'" appSanitizeInput [noSpaceAllow]="true" />
        </app-form-fields>

        <button type="submit"
            class="u-gradient-btn w-full py-2 rounded-lg font-semibold text-white mt-6 transition hover:opacity-90 disabled:opacity-50">
            Sign Up
        </button>

        <div class="text-center mt-6">
            <p class="text-gray-600 text-sm">Already have an account?
                <a href="#" class="text-blue-600 hover:text-blue-700 font-semibold">
                    Sign in
                </a>
            </p>
        </div>
    </form>
    }
</div>